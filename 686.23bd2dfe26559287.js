"use strict";(self.webpackChunkrecuento_inventory=self.webpackChunkrecuento_inventory||[]).push([[686],{6305:(M,O,i)=>{i.r(O),i.d(O,{StockComponent:()=>S});var E=i(177),k=i(8094),C=i(4341),h=i(4412),y=i(4572),f=i(6354),j=i(9172),e=i(4438),D=i(6241);const A=(p,x,t,u)=>({"bg-red-100 text-red-800":p,"bg-yellow-100 text-yellow-800":x,"bg-orange-100 text-orange-800":t,"bg-green-100 text-green-800":u}),T=(p,x,t,u,n)=>({"bg-green-100 text-green-800":p,"bg-gray-100 text-gray-800":x,"bg-red-100 text-red-800":t,"bg-purple-100 text-purple-800":u,"bg-blue-100 text-blue-800":n}),s=p=>["/productos",p,"editar"];function r(p,x){if(1&p&&(e.j41(0,"option",50),e.EFF(1),e.k0s()),2&p){const t=x.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function m(p,x){1&p&&(e.j41(0,"tr")(1,"td",51)(2,"div",52),e.qSk(),e.j41(3,"svg",53),e.nrm(4,"path",16),e.k0s(),e.joV(),e.j41(5,"p"),e.EFF(6,"No se encontraron productos"),e.k0s()()()())}function b(p,x){1&p&&(e.j41(0,"div",71),e.qSk(),e.j41(1,"svg",72),e.nrm(2,"path",20),e.k0s()())}function _(p,x){if(1&p){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",54)(3,"div",55),e.qSk(),e.j41(4,"svg",56),e.nrm(5,"path",57)(6,"path",58),e.k0s()(),e.joV(),e.j41(7,"div")(8,"p",59),e.EFF(9),e.k0s(),e.j41(10,"p",60),e.EFF(11),e.k0s()()()(),e.j41(12,"td")(13,"div")(14,"p",61),e.EFF(15),e.k0s(),e.j41(16,"p",62),e.EFF(17),e.k0s()()(),e.j41(18,"td")(19,"div")(20,"p",61),e.EFF(21),e.k0s(),e.j41(22,"p",62),e.EFF(23),e.k0s()()(),e.j41(24,"td")(25,"div",63)(26,"span",64),e.EFF(27),e.k0s(),e.DNE(28,b,3,0,"div",65),e.k0s()(),e.j41(29,"td",61),e.EFF(30),e.nI1(31,"number"),e.k0s(),e.j41(32,"td",59),e.EFF(33),e.nI1(34,"number"),e.k0s(),e.j41(35,"td",60),e.EFF(36),e.k0s(),e.j41(37,"td")(38,"span",64),e.EFF(39),e.k0s()(),e.j41(40,"td")(41,"div",63)(42,"button",66),e.bIt("click",function(){const n=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.adjustStock(n,"increase"))}),e.qSk(),e.j41(43,"svg",6),e.nrm(44,"path",9),e.k0s()(),e.joV(),e.j41(45,"button",67),e.bIt("click",function(){const n=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.adjustStock(n,"decrease"))}),e.qSk(),e.j41(46,"svg",6),e.nrm(47,"path",68),e.k0s()(),e.joV(),e.j41(48,"a",69),e.qSk(),e.j41(49,"svg",6),e.nrm(50,"path",70),e.k0s()()()()()}if(2&p){const t=x.$implicit;e.R7$(9),e.SpI(" ",t.nombre," "),e.R7$(2),e.JRh(t.marca),e.R7$(4),e.JRh(t.codigo1),e.R7$(2),e.JRh(t.codigo2),e.R7$(4),e.JRh(t.categoria),e.R7$(2),e.JRh(t.rubro),e.R7$(3),e.Y8G("ngClass",e.ziG(22,A,0===t.cantidad,t.cantidad>0&&t.cantidad<=5,t.cantidad>5&&t.cantidad<=10,t.cantidad>10)),e.R7$(),e.SpI(" ",t.cantidad," "),e.R7$(),e.Y8G("ngIf",t.cantidad<=10),e.R7$(2),e.SpI(" $",e.i5U(31,16,t.precio,"1.2-2")," "),e.R7$(3),e.SpI(" $",e.i5U(34,19,t.precio*t.cantidad,"1.2-2")," "),e.R7$(3),e.JRh(t.ubicacion),e.R7$(2),e.Y8G("ngClass",e.s1E(27,T,"ACTIVO"===t.status,"INACTIVO"===t.status,"AGOTADO"===t.status,"VENCIDO"===t.status,"RESERVADO"===t.status)),e.R7$(),e.SpI(" ",t.status," "),e.R7$(6),e.Y8G("disabled",0===t.cantidad),e.R7$(3),e.Y8G("routerLink",e.eq3(33,s,t.id))}}let S=(()=>{class p{constructor(t){this.productService=t,this.searchSubject=new h.t(""),this.categorySubject=new h.t(""),this.stockLevelSubject=new h.t(""),this.searchQuery="",this.selectedCategory="",this.selectedStockLevel="",this.products$=this.productService.getProducts(),this.categories$=this.products$.pipe((0,f.T)(u=>[...new Set(u.map(n=>n.categoria))].sort())),this.filteredProducts$=(0,y.z)([this.products$,this.searchSubject.pipe((0,j.Z)("")),this.categorySubject.pipe((0,j.Z)("")),this.stockLevelSubject.pipe((0,j.Z)(""))]).pipe((0,f.T)(([u,n,d,c])=>u.filter(g=>{const v=!n||g.nombre.toLowerCase().includes(n.toLowerCase())||g.codigo1.toLowerCase().includes(n.toLowerCase())||g.codigo2.toLowerCase().includes(n.toLowerCase())||g.marca.toLowerCase().includes(n.toLowerCase());let a=!0;return"normal"===c?a=g.cantidad>10:"bajo"===c?a=g.cantidad>0&&g.cantidad<=10:"agotado"===c&&(a=0===g.cantidad),v&&(!d||g.categoria===d)&&a}))),this.totalStock$=this.products$.pipe((0,f.T)(u=>u.reduce((n,d)=>n+d.cantidad,0))),this.totalValue$=this.products$.pipe((0,f.T)(u=>u.reduce((n,d)=>n+d.precio*d.cantidad,0))),this.lowStockCount$=this.products$.pipe((0,f.T)(u=>u.filter(n=>n.cantidad>0&&n.cantidad<=10).length)),this.outOfStockCount$=this.products$.pipe((0,f.T)(u=>u.filter(n=>0===n.cantidad).length))}ngOnInit(){}onSearchChange(t){this.searchSubject.next(t)}onCategoryChange(t){this.categorySubject.next(t)}onStockLevelChange(t){this.stockLevelSubject.next(t)}clearFilters(){this.searchQuery="",this.selectedCategory="",this.selectedStockLevel="",this.searchSubject.next(""),this.categorySubject.next(""),this.stockLevelSubject.next("")}adjustStock(t,u){const n=prompt(`Ingresa la cantidad a ${"increase"===u?"agregar":"quitar"}:`,"1");if(n){const d=parseInt(n,10);if(isNaN(d)||d<=0)return void alert("Por favor ingresa una cantidad v\xe1lida.");const c="increase"===u?t.cantidad+d:Math.max(0,t.cantidad-d),g={...t,cantidad:c,precio:t.precio};this.productService.updateProduct(t.id,g).subscribe({next:()=>{console.log("Stock actualizado exitosamente")},error:v=>{console.error("Error al actualizar stock:",v),alert("Error al actualizar el stock. Intenta de nuevo.")}})}}exportData(){this.filteredProducts$.subscribe(t=>{const u=t.map(g=>({Producto:g.nombre,C\u00f3digo:g.codigo1,Marca:g.marca,Categor\u00eda:g.categoria,Stock:g.cantidad,Precio:g.precio,"Valor Total":g.precio*g.cantidad,Ubicaci\u00f3n:g.ubicacion,Estado:g.status})),n=this.convertToCSV(u),d=new Blob([n],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");if(void 0!==c.download){const g=URL.createObjectURL(d);c.setAttribute("href",g),c.setAttribute("download",`stock_${(new Date).toISOString().split("T")[0]}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}})}convertToCSV(t){return 0===t.length?"":[Object.keys(t[0]).join(","),...t.map(d=>Object.values(d).map(c=>`"${c}"`).join(","))].join("\n")}static{this.\u0275fac=function(u){return new(u||p)(e.rXU(D.b))}}static{this.\u0275cmp=e.VBU({type:p,selectors:[["app-stock"]],standalone:!0,features:[e.aNF],decls:125,vars:27,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"flex","space-x-3"],[1,"btn","btn-secondary","flex","items-center","space-x-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["routerLink","/productos/nuevo",1,"btn","btn-primary","flex","items-center","space-x-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"card","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-600"],[1,"w-12","h-12","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-blue-600"],["d","M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"w-12","h-12","bg-yellow-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-yellow-600"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-2xl","font-bold","text-red-600"],[1,"w-12","h-12","bg-red-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-red-600"],["fill-rule","evenodd","d","M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z","clip-rule","evenodd"],[1,"text-2xl","font-bold","text-green-600"],[1,"w-12","h-12","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-green-600"],["d","M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z","clip-rule","evenodd"],[1,"card","p-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","placeholder","Nombre, c\xf3digo...",1,"input",3,"ngModelChange","ngModel"],[1,"input",3,"ngModelChange","ngModel"],["value",""],["value","normal"],["value","bajo"],["value","agotado"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","items-end"],["type","button",1,"btn","btn-secondary","w-full",3,"click"],[1,"card","overflow-hidden"],[1,"p-4","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"table"],[1,"bg-gray-50"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],["colspan","9",1,"text-center","py-8","text-gray-500"],[1,"flex","flex-col","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-12","h-12","mb-3","text-gray-300"],[1,"flex","items-center","space-x-3"],[1,"w-10","h-10","bg-gray-200","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-gray-500"],["fill-rule","evenodd","d","M4 3a2 2 0 100 4h12a2 2 0 100-4H4z"],["fill-rule","evenodd","d","M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","space-x-2"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["class","w-4 h-4 text-yellow-500","title","Stock bajo",4,"ngIf"],["title","Aumentar stock",1,"text-green-600","hover:text-green-900","text-sm",3,"click"],["title","Disminuir stock",1,"text-red-600","hover:text-red-900","text-sm",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 12H4"],["title","Editar",1,"text-primary-600","hover:text-primary-900","text-sm",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Stock bajo",1,"w-4","h-4","text-yellow-500"],["fill","currentColor","viewBox","0 0 20 20"]],template:function(u,n){if(1&u&&(e.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Gesti\xf3n de Stock"),e.k0s(),e.j41(5,"p",3),e.EFF(6,"Control y monitoreo de existencias"),e.k0s()(),e.j41(7,"div",4)(8,"button",5),e.bIt("click",function(){return n.exportData()}),e.qSk(),e.j41(9,"svg",6),e.nrm(10,"path",7),e.k0s(),e.joV(),e.j41(11,"span"),e.EFF(12,"Exportar"),e.k0s()(),e.j41(13,"a",8),e.qSk(),e.j41(14,"svg",6),e.nrm(15,"path",9),e.k0s(),e.joV(),e.j41(16,"span"),e.EFF(17,"Nuevo Producto"),e.k0s()()()(),e.j41(18,"div",10)(19,"div",11)(20,"div",12)(21,"div")(22,"p",13),e.EFF(23,"Stock Total"),e.k0s(),e.j41(24,"p",2),e.EFF(25),e.nI1(26,"async"),e.k0s()(),e.j41(27,"div",14),e.qSk(),e.j41(28,"svg",15),e.nrm(29,"path",16),e.k0s()()()(),e.joV(),e.j41(30,"div",11)(31,"div",12)(32,"div")(33,"p",13),e.EFF(34,"Stock Bajo"),e.k0s(),e.j41(35,"p",17),e.EFF(36),e.nI1(37,"async"),e.k0s()(),e.j41(38,"div",18),e.qSk(),e.j41(39,"svg",19),e.nrm(40,"path",20),e.k0s()()()(),e.joV(),e.j41(41,"div",11)(42,"div",12)(43,"div")(44,"p",13),e.EFF(45,"Agotados"),e.k0s(),e.j41(46,"p",21),e.EFF(47),e.nI1(48,"async"),e.k0s()(),e.j41(49,"div",22),e.qSk(),e.j41(50,"svg",23),e.nrm(51,"path",24),e.k0s()()()(),e.joV(),e.j41(52,"div",11)(53,"div",12)(54,"div")(55,"p",13),e.EFF(56,"Valor Total"),e.k0s(),e.j41(57,"p",25),e.EFF(58),e.nI1(59,"async"),e.nI1(60,"number"),e.k0s()(),e.j41(61,"div",26),e.qSk(),e.j41(62,"svg",27),e.nrm(63,"path",28)(64,"path",29),e.k0s()()()()(),e.joV(),e.j41(65,"div",30)(66,"div",31)(67,"div")(68,"label",32),e.EFF(69," Buscar "),e.k0s(),e.j41(70,"input",33),e.mxI("ngModelChange",function(c){return e.DH7(n.searchQuery,c)||(n.searchQuery=c),c}),e.bIt("ngModelChange",function(c){return n.onSearchChange(c)}),e.k0s()(),e.j41(71,"div")(72,"label",32),e.EFF(73," Nivel de Stock "),e.k0s(),e.j41(74,"select",34),e.mxI("ngModelChange",function(c){return e.DH7(n.selectedStockLevel,c)||(n.selectedStockLevel=c),c}),e.bIt("ngModelChange",function(c){return n.onStockLevelChange(c)}),e.j41(75,"option",35),e.EFF(76,"Todos"),e.k0s(),e.j41(77,"option",36),e.EFF(78,"Stock Normal (>10)"),e.k0s(),e.j41(79,"option",37),e.EFF(80,"Stock Bajo (1-10)"),e.k0s(),e.j41(81,"option",38),e.EFF(82,"Agotado (0)"),e.k0s()()(),e.j41(83,"div")(84,"label",32),e.EFF(85," Categor\xeda "),e.k0s(),e.j41(86,"select",34),e.mxI("ngModelChange",function(c){return e.DH7(n.selectedCategory,c)||(n.selectedCategory=c),c}),e.bIt("ngModelChange",function(c){return n.onCategoryChange(c)}),e.j41(87,"option",35),e.EFF(88,"Todas"),e.k0s(),e.DNE(89,r,2,2,"option",39),e.nI1(90,"async"),e.k0s()(),e.j41(91,"div",40)(92,"button",41),e.bIt("click",function(){return n.clearFilters()}),e.EFF(93," Limpiar "),e.k0s()()()(),e.j41(94,"div",42)(95,"div",43)(96,"h3",44),e.EFF(97,"Control de Stock"),e.k0s()(),e.j41(98,"div",45)(99,"table",46)(100,"thead",47)(101,"tr")(102,"th"),e.EFF(103,"Producto"),e.k0s(),e.j41(104,"th"),e.EFF(105,"C\xf3digo"),e.k0s(),e.j41(106,"th"),e.EFF(107,"Categor\xeda"),e.k0s(),e.j41(108,"th"),e.EFF(109,"Stock Actual"),e.k0s(),e.j41(110,"th"),e.EFF(111,"Valor Unitario"),e.k0s(),e.j41(112,"th"),e.EFF(113,"Valor Total"),e.k0s(),e.j41(114,"th"),e.EFF(115,"Ubicaci\xf3n"),e.k0s(),e.j41(116,"th"),e.EFF(117,"Estado"),e.k0s(),e.j41(118,"th"),e.EFF(119,"Acciones"),e.k0s()()(),e.j41(120,"tbody"),e.DNE(121,m,7,0,"tr",48),e.nI1(122,"async"),e.DNE(123,_,51,35,"tr",49),e.nI1(124,"async"),e.k0s()()()()()),2&u){let d;e.R7$(25),e.SpI(" ",e.bMT(26,10,n.totalStock$)," "),e.R7$(11),e.SpI(" ",e.bMT(37,12,n.lowStockCount$)," "),e.R7$(11),e.SpI(" ",e.bMT(48,14,n.outOfStockCount$)," "),e.R7$(11),e.SpI(" $",e.i5U(60,18,e.bMT(59,16,n.totalValue$),"1.2-2")," "),e.R7$(12),e.R50("ngModel",n.searchQuery),e.R7$(4),e.R50("ngModel",n.selectedStockLevel),e.R7$(12),e.R50("ngModel",n.selectedCategory),e.R7$(3),e.Y8G("ngForOf",e.bMT(90,21,n.categories$)),e.R7$(32),e.Y8G("ngIf",0===(null==(d=e.bMT(122,23,n.filteredProducts$))?null:d.length)),e.R7$(2),e.Y8G("ngForOf",e.bMT(124,25,n.filteredProducts$))}},dependencies:[E.MD,E.YU,E.Sq,E.bT,E.Jj,E.QX,k.iI,k.Wk,C.YN,C.xH,C.y7,C.me,C.wz,C.BC,C.vS],encapsulation:2})}}return p})()},2181:(M,O,i)=>{i.d(O,{Sz:()=>E,UB:()=>k,vT:()=>C});var E=function(h){return h.ACTIVO="ACTIVO",h.INACTIVO="INACTIVO",h.AGOTADO="AGOTADO",h.VENCIDO="VENCIDO",h.RESERVADO="RESERVADO",h}(E||{}),k=function(h){return h.ENTRADA="ENTRADA",h.SALIDA="SALIDA",h.AJUSTE="AJUSTE",h.TRANSFERENCIA="TRANSFERENCIA",h.DEVOLUCION="DEVOLUCION",h}(k||{}),C=function(h){return h.STOCK_BAJO="STOCK_BAJO",h.PRODUCTO_VENCIDO="PRODUCTO_VENCIDO",h.PRODUCTO_POR_VENCER="PRODUCTO_POR_VENCER",h.STOCK_AGOTADO="STOCK_AGOTADO",h}(C||{})},6241:(M,O,i)=>{i.d(O,{b:()=>D});var E=i(4412),k=i(7673),C=i(8810),h=i(6354),y=i(8384),f=i(2181),j=i(4438),e=i(7156);let D=(()=>{class A{constructor(s){this.http=s,this.products=new E.t([]),this.movements=new E.t([]),this.alerts=new E.t([]),this.products$=this.products.asObservable(),this.movements$=this.movements.asObservable(),this.alerts$=this.alerts.asObservable(),this.loadDemoData()}loadDemoData(){const s=[{id:"1",nombre:"Laptop HP Pavilion",descripcion:"Laptop HP Pavilion 15.6 pulgadas, 8GB RAM, 256GB SSD",precio:899.99,proveedor:"HP Inc.",cantidad:15,codigo1:"HP-LAP-001",codigo2:"PAV-156-8256",imagenes:["laptop-hp.jpg"],rubro:"Electr\xf3nicos",categoria:"Computadoras",marca:"HP",fechaVencimiento:void 0,lote:"LOT-2024-001",status:f.Sz.ACTIVO,notas:"Modelo m\xe1s vendido de la marca",ubicacion:"Almac\xe9n A - Estante 1",fechaCreacion:new Date("2024-01-15"),fechaActualizacion:new Date("2024-01-20")},{id:"2",nombre:"Mouse Inal\xe1mbrico Logitech",descripcion:"Mouse inal\xe1mbrico Logitech MX Master 3",precio:79.99,proveedor:"Logitech",cantidad:5,codigo1:"LOG-MOU-001",codigo2:"MX-MST-3",imagenes:["mouse-logitech.jpg"],rubro:"Electr\xf3nicos",categoria:"Accesorios",marca:"Logitech",fechaVencimiento:void 0,lote:"LOT-2024-002",status:f.Sz.ACTIVO,notas:"Stock bajo - reabastecer pronto",ubicacion:"Almac\xe9n A - Estante 2",fechaCreacion:new Date("2024-01-10"),fechaActualizacion:new Date("2024-01-18")},{id:"3",nombre:"Medicamento Paracetamol",descripcion:"Paracetamol 500mg - Caja con 20 tabletas",precio:5.99,proveedor:"Farmac\xe9utica ABC",cantidad:0,codigo1:"MED-PAR-001",codigo2:"PAR-500-20",imagenes:["paracetamol.jpg"],rubro:"Farmacia",categoria:"Analg\xe9sicos",marca:"Gen\xe9rico",fechaVencimiento:new Date("2024-12-31"),lote:"LOT-2024-003",status:f.Sz.AGOTADO,notas:"Producto agotado - pedido urgente",ubicacion:"Farmacia - Estante B",fechaCreacion:new Date("2024-01-05"),fechaActualizacion:new Date("2024-01-22")}],r=[{id:"1",productId:"1",tipo:f.UB.ENTRADA,cantidad:20,cantidadAnterior:0,cantidadNueva:20,motivo:"Compra inicial de inventario",usuario:"admin@inventory.com",fecha:new Date("2024-01-15"),lote:"LOT-2024-001",ubicacion:"Almac\xe9n A - Estante 1"},{id:"2",productId:"1",tipo:f.UB.SALIDA,cantidad:5,cantidadAnterior:20,cantidadNueva:15,motivo:"Venta al cliente",usuario:"manager@inventory.com",fecha:new Date("2024-01-20"),lote:"LOT-2024-001",ubicacion:"Almac\xe9n A - Estante 1"}],m=[{id:"1",productId:"2",tipo:f.vT.STOCK_BAJO,message:"Stock bajo: Mouse Inal\xe1mbrico Logitech (5 unidades)",fecha:new Date,leido:!1},{id:"2",productId:"3",tipo:f.vT.STOCK_AGOTADO,message:"Stock agotado: Medicamento Paracetamol",fecha:new Date,leido:!1}];this.products.next(s),this.movements.next(r),this.alerts.next(m)}getProducts(){return this.products$}getProduct(s){return this.products$.pipe((0,h.T)(r=>r.find(m=>m.id===s)))}createProduct(s){const r={id:this.generateId(),...s,precio:Number(s.precio),cantidad:Number(s.cantidad),imagenes:[],fechaVencimiento:s.fechaVencimiento?new Date(s.fechaVencimiento):void 0,fechaCreacion:new Date,fechaActualizacion:new Date};return this.products.next([...this.products.value,r]),this.addInventoryMovement({productId:r.id,tipo:f.UB.ENTRADA,cantidad:r.cantidad,cantidadAnterior:0,cantidadNueva:r.cantidad,motivo:"Creaci\xf3n de producto",usuario:"current-user",fecha:new Date,lote:r.lote,ubicacion:r.ubicacion}),(0,k.of)(r).pipe((0,y.c)(500))}updateProduct(s,r){const m=this.products.value,b=m.findIndex(p=>p.id===s);if(-1===b)return(0,C.$)(()=>new Error("Producto no encontrado"));const _=m[b],S={..._,...r,precio:Number(r.precio),cantidad:Number(r.cantidad),fechaVencimiento:r.fechaVencimiento?new Date(r.fechaVencimiento):void 0,fechaActualizacion:new Date};if(_.cantidad!==S.cantidad){const p=S.cantidad-_.cantidad;this.addInventoryMovement({productId:s,tipo:p>0?f.UB.ENTRADA:f.UB.SALIDA,cantidad:Math.abs(p),cantidadAnterior:_.cantidad,cantidadNueva:S.cantidad,motivo:"Ajuste de inventario",usuario:"current-user",fecha:new Date,lote:S.lote,ubicacion:S.ubicacion})}return m[b]=S,this.products.next([...m]),(0,k.of)(S).pipe((0,y.c)(500))}deleteProduct(s){const m=this.products.value.filter(b=>b.id!==s);return this.products.next(m),(0,k.of)(!0).pipe((0,y.c)(500))}getInventoryMovements(){return this.movements$}addInventoryMovement(s){const r={id:this.generateId(),...s};this.movements.next([r,...this.movements.value])}getStockAlerts(){return this.alerts$}markAlertAsRead(s){const r=this.alerts.value,m=r.findIndex(b=>b.id===s);return-1!==m&&(r[m].leido=!0,this.alerts.next([...r])),(0,k.of)(!0)}generateId(){return Date.now().toString()+Math.random().toString(36).substr(2,5)}searchProducts(s){return this.products$.pipe((0,h.T)(r=>r.filter(m=>m.nombre.toLowerCase().includes(s.toLowerCase())||m.codigo1.toLowerCase().includes(s.toLowerCase())||m.codigo2.toLowerCase().includes(s.toLowerCase())||m.marca.toLowerCase().includes(s.toLowerCase()))))}getProductsByCategory(s){return this.products$.pipe((0,h.T)(r=>r.filter(m=>m.categoria===s)))}getLowStockProducts(s=10){return this.products$.pipe((0,h.T)(r=>r.filter(m=>m.cantidad<=s)))}static{this.\u0275fac=function(r){return new(r||A)(j.KVO(e.Qq))}}static{this.\u0275prov=j.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}}return A})()},8384:(M,O,i)=>{i.d(O,{c:()=>g});var E=i(8359);class k extends E.yU{constructor(o,a){super()}schedule(o,a=0){return this}}const C={setInterval(v,o,...a){const{delegate:l}=C;return l?.setInterval?l.setInterval(v,o,...a):setInterval(v,o,...a)},clearInterval(v){const{delegate:o}=C;return(o?.clearInterval||clearInterval)(v)},delegate:void 0};var h=i(7908);const f={now:()=>(f.delegate||Date).now(),delegate:void 0};class j{constructor(o,a=j.now){this.schedulerActionCtor=o,this.now=a}schedule(o,a=0,l){return new this.schedulerActionCtor(this,o).schedule(l,a)}}j.now=f.now;const D=new class e extends j{constructor(o,a=j.now){super(o,a),this.actions=[],this._active=!1}flush(o){const{actions:a}=this;if(this._active)return void a.push(o);let l;this._active=!0;do{if(l=o.execute(o.state,o.delay))break}while(o=a.shift());if(this._active=!1,l){for(;o=a.shift();)o.unsubscribe();throw l}}}(class y extends k{constructor(o,a){super(o,a),this.scheduler=o,this.work=a,this.pending=!1}schedule(o,a=0){var l;if(this.closed)return this;this.state=o;const I=this.id,F=this.scheduler;return null!=I&&(this.id=this.recycleAsyncId(F,I,a)),this.pending=!0,this.delay=a,this.id=null!==(l=this.id)&&void 0!==l?l:this.requestAsyncId(F,this.id,a),this}requestAsyncId(o,a,l=0){return C.setInterval(o.flush.bind(o,this),l)}recycleAsyncId(o,a,l=0){if(null!=l&&this.delay===l&&!1===this.pending)return a;null!=a&&C.clearInterval(a)}execute(o,a){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const l=this._execute(o,a);if(l)return l;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(o,a){let I,l=!1;try{this.work(o)}catch(F){l=!0,I=F||new Error("Scheduled action threw falsy error")}if(l)return this.unsubscribe(),I}unsubscribe(){if(!this.closed){const{id:o,scheduler:a}=this,{actions:l}=a;this.work=this.state=this.scheduler=null,this.pending=!1,(0,h.o)(l,this),null!=o&&(this.id=this.recycleAsyncId(a,o,null)),this.delay=null,super.unsubscribe()}}}),A=D;var T=i(8793),s=i(6697),r=i(9974),m=i(4360),b=i(5343),S=i(3703),p=i(1397),x=i(8750);function t(v,o){return o?a=>(0,T.x)(o.pipe((0,s.s)(1),function _(){return(0,r.N)((v,o)=>{v.subscribe((0,m._)(o,b.l))})}()),a.pipe(t(v))):(0,p.Z)((a,l)=>(0,x.Tg)(v(a,l)).pipe((0,s.s)(1),(0,S.u)(a)))}var u=i(1985),n=i(9470);function g(v,o=D){const a=function c(v=0,o,a=A){let l=-1;return null!=o&&((0,n.m)(o)?a=o:l=o),new u.c(I=>{let F=function d(v){return v instanceof Date&&!isNaN(v)}(v)?+v-a.now():v;F<0&&(F=0);let w=0;return a.schedule(function(){I.closed||(I.next(w++),0<=l?this.schedule(void 0,l):I.complete())},F)})}(v,o);return t(()=>a)}}}]);