"use strict";(self.webpackChunkrecuento_inventory=self.webpackChunkrecuento_inventory||[]).push([[764],{6764:(F,b,s)=>{s.r(b),s.d(b,{DashboardComponent:()=>k});var p=s(177),f=s(8094),e=s(4438),v=s(4796),I=s(6241),m=s(4572),C=s(6354),j=s(2181);let w=(()=>{class l{constructor(t){this.productService=t}getReportData(t){return(0,m.z)([this.productService.getProducts(),this.productService.getInventoryMovements(),this.productService.getStockAlerts()]).pipe((0,C.T)(([i,r,o])=>{let n=i,a=r;return t&&(n=this.applyProductFilters(i,t),a=this.applyMovementFilters(r,t)),this.generateReportData(n,a,o)}))}applyProductFilters(t,i){let r=t;return i.categoria&&(r=r.filter(o=>o.categoria===i.categoria)),i.proveedor&&(r=r.filter(o=>o.proveedor===i.proveedor)),i.ubicacion&&(r=r.filter(o=>o.ubicacion===i.ubicacion)),i.estado&&(r=r.filter(o=>o.status===i.estado)),r}applyMovementFilters(t,i){let r=t;return i.fechaInicio&&(r=r.filter(o=>o.fecha>=i.fechaInicio)),i.fechaFin&&(r=r.filter(o=>o.fecha<=i.fechaFin)),r}generateReportData(t,i,r){return{totalProducts:t.length,totalStock:t.reduce((O,P)=>O+P.cantidad,0),lowStockProducts:t.filter(O=>O.cantidad<=10).length,expiredProducts:t.filter(O=>this.isExpired(O)).length,expiringProducts:t.filter(O=>this.isExpiringSoon(O)).length,totalValue:t.reduce((O,P)=>O+P.precio*P.cantidad,0),topProducts:this.getTopProducts(t,i),stockByCategory:this.getStockByCategory(t),movementsByMonth:this.getMovementsByMonth(i),alertsSummary:this.getAlertsSummary(r)}}getTopProducts(t,i){const r=new Map;return i.forEach(o=>{const n=r.get(o.productId)||0;r.set(o.productId,n+o.cantidad)}),t.map(o=>({id:o.id,nombre:o.nombre,cantidad:o.cantidad,valor:o.precio*o.cantidad,movimientos:r.get(o.id)||0})).sort((o,n)=>n.movimientos-o.movimientos).slice(0,10)}getStockByCategory(t){const i=new Map;return t.forEach(r=>{const o=i.get(r.categoria)||{categoria:r.categoria,cantidad:0,valor:0,productos:0};o.cantidad+=r.cantidad,o.valor+=r.precio*r.cantidad,o.productos+=1,i.set(r.categoria,o)}),Array.from(i.values()).sort((r,o)=>o.valor-r.valor)}getMovementsByMonth(t){const i=new Map;return t.forEach(r=>{const o=r.fecha.toISOString().substring(0,7),n=i.get(o)||{mes:o,entradas:0,salidas:0,ajustes:0};switch(r.tipo){case"ENTRADA":n.entradas+=r.cantidad;break;case"SALIDA":n.salidas+=r.cantidad;break;case"AJUSTE":n.ajustes+=r.cantidad}i.set(o,n)}),Array.from(i.values()).sort((r,o)=>r.mes.localeCompare(o.mes))}getAlertsSummary(t){return{stockBajo:t.filter(i=>i.tipo===j.vT.STOCK_BAJO).length,productosVencidos:t.filter(i=>i.tipo===j.vT.PRODUCTO_VENCIDO).length,productosPorVencer:t.filter(i=>i.tipo===j.vT.PRODUCTO_POR_VENCER).length,stockAgotado:t.filter(i=>i.tipo===j.vT.STOCK_AGOTADO).length}}isExpired(t){return!!t.fechaVencimiento&&new Date>t.fechaVencimiento}isExpiringSoon(t,i=30){if(!t.fechaVencimiento)return!1;const r=new Date;return r.setDate(r.getDate()+i),t.fechaVencimiento<=r&&t.fechaVencimiento>new Date}exportToCSV(t,i){const r=this.convertToCSV(t),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(void 0!==n.download){const a=URL.createObjectURL(o);n.setAttribute("href",a),n.setAttribute("download",i),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}convertToCSV(t){return 0===t.length?"":[Object.keys(t[0]).join(","),...t.map(o=>Object.values(o).map(n=>`"${n}"`).join(","))].join("\n")}static{this.\u0275fac=function(i){return new(i||l)(e.KVO(I.b))}}static{this.\u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();const D=(l,g)=>({"bg-red-100":l,"bg-yellow-100":g}),M=(l,g)=>({"text-red-600":l,"text-yellow-600":g}),d=(l,g,t)=>({"bg-red-100 text-red-800":l,"bg-yellow-100 text-yellow-800":g,"bg-orange-100 text-orange-800":t});function c(l,g){if(1&l&&(e.j41(0,"div",37)(1,"div",15)(2,"div",38)(3,"div")(4,"p",39),e.EFF(5,"Total Productos"),e.k0s(),e.j41(6,"p",2),e.EFF(7),e.k0s()(),e.j41(8,"div",40),e.qSk(),e.j41(9,"svg",41),e.nrm(10,"path",35)(11,"path",36),e.k0s()()()(),e.joV(),e.j41(12,"div",15)(13,"div",38)(14,"div")(15,"p",39),e.EFF(16,"Stock Total"),e.k0s(),e.j41(17,"p",2),e.EFF(18),e.k0s()(),e.j41(19,"div",42),e.qSk(),e.j41(20,"svg",43),e.nrm(21,"path",44),e.k0s()()()(),e.joV(),e.j41(22,"div",15)(23,"div",38)(24,"div")(25,"p",39),e.EFF(26,"Valor Total"),e.k0s(),e.j41(27,"p",2),e.EFF(28),e.nI1(29,"number"),e.k0s()(),e.j41(30,"div",45),e.qSk(),e.j41(31,"svg",46),e.nrm(32,"path",47)(33,"path",48),e.k0s()()()(),e.joV(),e.j41(34,"div",15)(35,"div",38)(36,"div")(37,"p",39),e.EFF(38,"Alertas"),e.k0s(),e.j41(39,"p",49),e.EFF(40),e.nI1(41,"async"),e.k0s()(),e.j41(42,"div",50),e.qSk(),e.j41(43,"svg",51),e.nrm(44,"path",52),e.k0s()()()()()),2&l){let t;const i=g.ngIf,r=e.XpG();e.R7$(7),e.SpI(" ",i.totalProducts," "),e.R7$(11),e.SpI(" ",i.totalStock," "),e.R7$(10),e.SpI(" $",e.i5U(29,4,i.totalValue,"1.2-2")," "),e.R7$(12),e.SpI(" ",(null==(t=e.bMT(41,7,r.alerts$))?null:t.length)||0," ")}}function h(l,g){1&l&&(e.j41(0,"div",53),e.qSk(),e.j41(1,"svg",54),e.nrm(2,"path",55),e.k0s(),e.joV(),e.j41(3,"p"),e.EFF(4,"No hay alertas pendientes"),e.k0s()())}function A(l,g){if(1&l&&(e.j41(0,"div",56)(1,"div",57)(2,"div",58)(3,"div",59),e.qSk(),e.j41(4,"svg",60),e.nrm(5,"path",52),e.k0s()()(),e.joV(),e.j41(6,"div",61)(7,"p",62),e.EFF(8),e.k0s(),e.j41(9,"p",63),e.EFF(10),e.nI1(11,"date"),e.k0s()()()()),2&l){const t=g.$implicit;e.R7$(3),e.Y8G("ngClass",e.l_i(7,D,"STOCK_AGOTADO"===t.tipo||"PRODUCTO_VENCIDO"===t.tipo,"STOCK_BAJO"===t.tipo||"PRODUCTO_POR_VENCER"===t.tipo)),e.R7$(),e.Y8G("ngClass",e.l_i(10,M,"STOCK_AGOTADO"===t.tipo||"PRODUCTO_VENCIDO"===t.tipo,"STOCK_BAJO"===t.tipo||"PRODUCTO_POR_VENCER"===t.tipo)),e.R7$(4),e.JRh(t.message),e.R7$(2),e.SpI(" ",e.i5U(11,4,t.fecha,"dd/MM/yyyy HH:mm")," ")}}function S(l,g){1&l&&(e.j41(0,"div",64)(1,"a",65),e.EFF(2," Ver todas las alertas \u2192 "),e.k0s()())}function E(l,g){1&l&&(e.j41(0,"div",53),e.qSk(),e.j41(1,"svg",54),e.nrm(2,"path",55),e.k0s(),e.joV(),e.j41(3,"p"),e.EFF(4,"Todos los productos tienen stock suficiente"),e.k0s()())}function T(l,g){if(1&l&&(e.j41(0,"div",56)(1,"div",38)(2,"div",61)(3,"p",66),e.EFF(4),e.k0s(),e.j41(5,"p",5),e.EFF(6),e.k0s()(),e.j41(7,"div",4)(8,"span",67),e.EFF(9),e.k0s()()()()),2&l){const t=g.$implicit;e.R7$(4),e.SpI(" ",t.nombre," "),e.R7$(2),e.Lme(" ",t.marca," - ",t.codigo1," "),e.R7$(2),e.Y8G("ngClass",e.sMw(5,d,0===t.cantidad,t.cantidad>0&&t.cantidad<=5,t.cantidad>5&&t.cantidad<=10)),e.R7$(),e.SpI(" ",t.cantidad," unidades ")}}function R(l,g){1&l&&(e.j41(0,"div",64)(1,"a",68),e.EFF(2," Ver todos los productos \u2192 "),e.k0s()())}let k=(()=>{class l{constructor(t,i,r){this.authService=t,this.productService=i,this.reportService=r,this.currentUser=null,this.currentDate=new Date,this.reportData$=this.reportService.getReportData(),this.alerts$=this.productService.getStockAlerts(),this.lowStockProducts$=this.productService.getLowStockProducts()}ngOnInit(){this.authService.authState$.subscribe(t=>{this.currentUser=t.user})}static{this.\u0275fac=function(i){return new(i||l)(e.rXU(v.u),e.rXU(I.b),e.rXU(w))}}static{this.\u0275cmp=e.VBU({type:l,selectors:[["app-dashboard"]],standalone:!0,features:[e.aNF],decls:83,vars:38,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"text-right"],[1,"text-sm","text-gray-500"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",4,"ngIf"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"card"],[1,"p-6","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],[1,"divide-y","divide-gray-200"],["class","p-6 text-center text-gray-500",4,"ngIf"],["class","p-4",4,"ngFor","ngForOf"],["class","p-4 bg-gray-50",4,"ngIf"],[1,"card","p-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],["routerLink","/solicitud-pedido",1,"flex","items-center","p-4","bg-primary-50","rounded-lg","hover:bg-primary-100","transition-colors","duration-200"],[1,"w-10","h-10","bg-primary-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-primary-600"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule","evenodd"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-600"],["routerLink","/registro-factura",1,"flex","items-center","p-4","bg-green-50","rounded-lg","hover:bg-green-100","transition-colors","duration-200"],[1,"w-10","h-10","bg-green-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["routerLink","/salida-pedido",1,"flex","items-center","p-4","bg-purple-50","rounded-lg","hover:bg-purple-100","transition-colors","duration-200"],[1,"w-10","h-10","bg-purple-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],["routerLink","/productos/nuevo",1,"flex","items-center","p-4","bg-orange-50","rounded-lg","hover:bg-orange-100","transition-colors","duration-200"],[1,"w-10","h-10","bg-orange-100","rounded-lg","flex","items-center","justify-center","mr-3"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-orange-600"],["fill-rule","evenodd","d","M4 3a2 2 0 100 4h12a2 2 0 100-4H4z"],["fill-rule","evenodd","d","M3 8h14v7a2 2 0 01-2 2H5a2 2 0 01-2-2V8zm5 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z","clip-rule","evenodd"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-600"],[1,"w-12","h-12","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-blue-600"],[1,"w-12","h-12","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-green-600"],["d","M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],[1,"w-12","h-12","bg-yellow-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-yellow-600"],["d","M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z","clip-rule","evenodd"],[1,"text-2xl","font-bold","text-red-600"],[1,"w-12","h-12","bg-red-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-red-600"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"p-6","text-center","text-gray-500"],["fill","currentColor","viewBox","0 0 20 20",1,"w-12","h-12","mx-auto","mb-3","text-gray-300"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"p-4"],[1,"flex","items-start","space-x-3"],[1,"flex-shrink-0"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center",3,"ngClass"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"text-sm","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"p-4","bg-gray-50"],["routerLink","/inventario",1,"text-sm","text-primary-600","hover:text-primary-500"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],["routerLink","/stock",1,"text-sm","text-primary-600","hover:text-primary-500"]],template:function(i,r){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Dashboard"),e.k0s(),e.j41(5,"p",3),e.EFF(6,"Resumen general del inventario"),e.k0s()(),e.j41(7,"div",4)(8,"p",5),e.EFF(9),e.k0s(),e.j41(10,"p",5),e.EFF(11),e.nI1(12,"date"),e.k0s()()(),e.DNE(13,c,45,9,"div",6),e.nI1(14,"async"),e.j41(15,"div",7)(16,"div",8)(17,"div",9)(18,"h3",10),e.EFF(19,"Alertas Recientes"),e.k0s()(),e.j41(20,"div",11),e.DNE(21,h,5,0,"div",12),e.nI1(22,"async"),e.DNE(23,A,12,13,"div",13),e.nI1(24,"async"),e.nI1(25,"slice"),e.DNE(26,S,3,0,"div",14),e.nI1(27,"async"),e.nI1(28,"async"),e.k0s()(),e.j41(29,"div",8)(30,"div",9)(31,"h3",10),e.EFF(32," Productos con Stock Bajo "),e.k0s()(),e.j41(33,"div",11),e.DNE(34,E,5,0,"div",12),e.nI1(35,"async"),e.DNE(36,T,10,9,"div",13),e.nI1(37,"async"),e.nI1(38,"slice"),e.DNE(39,R,3,0,"div",14),e.nI1(40,"async"),e.nI1(41,"async"),e.k0s()()(),e.j41(42,"div",15)(43,"h3",16),e.EFF(44,"Accesos R\xe1pidos"),e.k0s(),e.j41(45,"div",17)(46,"a",18)(47,"div",19),e.qSk(),e.j41(48,"svg",20),e.nrm(49,"path",21),e.k0s()(),e.joV(),e.j41(50,"div")(51,"p",22),e.EFF(52,"Nueva Solicitud"),e.k0s(),e.j41(53,"p",23),e.EFF(54,"Solicitud de pedido"),e.k0s()()(),e.j41(55,"a",24)(56,"div",25),e.qSk(),e.j41(57,"svg",26),e.nrm(58,"path",27),e.k0s()(),e.joV(),e.j41(59,"div")(60,"p",22),e.EFF(61,"Registrar Factura"),e.k0s(),e.j41(62,"p",23),e.EFF(63,"Agregar nueva factura"),e.k0s()()(),e.j41(64,"a",28)(65,"div",29),e.qSk(),e.j41(66,"svg",30),e.nrm(67,"path",31),e.k0s()(),e.joV(),e.j41(68,"div")(69,"p",22),e.EFF(70,"Salida de Pedido"),e.k0s(),e.j41(71,"p",23),e.EFF(72,"Procesar entrega"),e.k0s()()(),e.j41(73,"a",32)(74,"div",33),e.qSk(),e.j41(75,"svg",34),e.nrm(76,"path",35)(77,"path",36),e.k0s()(),e.joV(),e.j41(78,"div")(79,"p",22),e.EFF(80,"Agregar Producto"),e.k0s(),e.j41(81,"p",23),e.EFF(82,"Nuevo producto"),e.k0s()()()()()()),2&i){let o,n;e.R7$(9),e.SpI(" Bienvenido, ",null==r.currentUser?null:r.currentUser.nombre," "),e.R7$(2),e.SpI(" ",e.i5U(12,9,r.currentDate,"dd/MM/yyyy")," "),e.R7$(2),e.Y8G("ngIf",e.bMT(14,12,r.reportData$)),e.R7$(8),e.Y8G("ngIf",0===(null==(o=e.bMT(22,14,r.alerts$))?null:o.length)),e.R7$(2),e.Y8G("ngForOf",e.brH(25,18,e.bMT(24,16,r.alerts$),0,5)),e.R7$(3),e.Y8G("ngIf",e.bMT(27,22,r.alerts$)&&e.bMT(28,24,r.alerts$).length>5),e.R7$(8),e.Y8G("ngIf",0===(null==(n=e.bMT(35,26,r.lowStockProducts$))?null:n.length)),e.R7$(2),e.Y8G("ngForOf",e.brH(38,30,e.bMT(37,28,r.lowStockProducts$),0,5)),e.R7$(3),e.Y8G("ngIf",e.bMT(40,34,r.lowStockProducts$)&&e.bMT(41,36,r.lowStockProducts$).length>5)}},dependencies:[p.MD,p.YU,p.Sq,p.bT,p.Jj,p.P9,p.QX,p.vh,f.iI,f.Wk],encapsulation:2})}}return l})()},2181:(F,b,s)=>{s.d(b,{Sz:()=>p,UB:()=>f,vT:()=>e});var p=function(v){return v.ACTIVO="ACTIVO",v.INACTIVO="INACTIVO",v.AGOTADO="AGOTADO",v.VENCIDO="VENCIDO",v.RESERVADO="RESERVADO",v}(p||{}),f=function(v){return v.ENTRADA="ENTRADA",v.SALIDA="SALIDA",v.AJUSTE="AJUSTE",v.TRANSFERENCIA="TRANSFERENCIA",v.DEVOLUCION="DEVOLUCION",v}(f||{}),e=function(v){return v.STOCK_BAJO="STOCK_BAJO",v.PRODUCTO_VENCIDO="PRODUCTO_VENCIDO",v.PRODUCTO_POR_VENCER="PRODUCTO_POR_VENCER",v.STOCK_AGOTADO="STOCK_AGOTADO",v}(e||{})},6241:(F,b,s)=>{s.d(b,{b:()=>w});var p=s(4412),f=s(7673),e=s(8810),v=s(6354),I=s(8384),m=s(2181),C=s(4438),j=s(7156);let w=(()=>{class D{constructor(d){this.http=d,this.products=new p.t([]),this.movements=new p.t([]),this.alerts=new p.t([]),this.products$=this.products.asObservable(),this.movements$=this.movements.asObservable(),this.alerts$=this.alerts.asObservable(),this.loadDemoData()}loadDemoData(){const d=[{id:"1",nombre:"Laptop HP Pavilion",descripcion:"Laptop HP Pavilion 15.6 pulgadas, 8GB RAM, 256GB SSD",precio:899.99,proveedor:"HP Inc.",cantidad:15,codigo1:"HP-LAP-001",codigo2:"PAV-156-8256",imagenes:["laptop-hp.jpg"],rubro:"Electr\xf3nicos",categoria:"Computadoras",marca:"HP",fechaVencimiento:void 0,lote:"LOT-2024-001",status:m.Sz.ACTIVO,notas:"Modelo m\xe1s vendido de la marca",ubicacion:"Almac\xe9n A - Estante 1",fechaCreacion:new Date("2024-01-15"),fechaActualizacion:new Date("2024-01-20")},{id:"2",nombre:"Mouse Inal\xe1mbrico Logitech",descripcion:"Mouse inal\xe1mbrico Logitech MX Master 3",precio:79.99,proveedor:"Logitech",cantidad:5,codigo1:"LOG-MOU-001",codigo2:"MX-MST-3",imagenes:["mouse-logitech.jpg"],rubro:"Electr\xf3nicos",categoria:"Accesorios",marca:"Logitech",fechaVencimiento:void 0,lote:"LOT-2024-002",status:m.Sz.ACTIVO,notas:"Stock bajo - reabastecer pronto",ubicacion:"Almac\xe9n A - Estante 2",fechaCreacion:new Date("2024-01-10"),fechaActualizacion:new Date("2024-01-18")},{id:"3",nombre:"Medicamento Paracetamol",descripcion:"Paracetamol 500mg - Caja con 20 tabletas",precio:5.99,proveedor:"Farmac\xe9utica ABC",cantidad:0,codigo1:"MED-PAR-001",codigo2:"PAR-500-20",imagenes:["paracetamol.jpg"],rubro:"Farmacia",categoria:"Analg\xe9sicos",marca:"Gen\xe9rico",fechaVencimiento:new Date("2024-12-31"),lote:"LOT-2024-003",status:m.Sz.AGOTADO,notas:"Producto agotado - pedido urgente",ubicacion:"Farmacia - Estante B",fechaCreacion:new Date("2024-01-05"),fechaActualizacion:new Date("2024-01-22")}],c=[{id:"1",productId:"1",tipo:m.UB.ENTRADA,cantidad:20,cantidadAnterior:0,cantidadNueva:20,motivo:"Compra inicial de inventario",usuario:"admin@inventory.com",fecha:new Date("2024-01-15"),lote:"LOT-2024-001",ubicacion:"Almac\xe9n A - Estante 1"},{id:"2",productId:"1",tipo:m.UB.SALIDA,cantidad:5,cantidadAnterior:20,cantidadNueva:15,motivo:"Venta al cliente",usuario:"manager@inventory.com",fecha:new Date("2024-01-20"),lote:"LOT-2024-001",ubicacion:"Almac\xe9n A - Estante 1"}],h=[{id:"1",productId:"2",tipo:m.vT.STOCK_BAJO,message:"Stock bajo: Mouse Inal\xe1mbrico Logitech (5 unidades)",fecha:new Date,leido:!1},{id:"2",productId:"3",tipo:m.vT.STOCK_AGOTADO,message:"Stock agotado: Medicamento Paracetamol",fecha:new Date,leido:!1}];this.products.next(d),this.movements.next(c),this.alerts.next(h)}getProducts(){return this.products$}getProduct(d){return this.products$.pipe((0,v.T)(c=>c.find(h=>h.id===d)))}createProduct(d){const c={id:this.generateId(),...d,precio:Number(d.precio),cantidad:Number(d.cantidad),imagenes:[],fechaVencimiento:d.fechaVencimiento?new Date(d.fechaVencimiento):void 0,fechaCreacion:new Date,fechaActualizacion:new Date};return this.products.next([...this.products.value,c]),this.addInventoryMovement({productId:c.id,tipo:m.UB.ENTRADA,cantidad:c.cantidad,cantidadAnterior:0,cantidadNueva:c.cantidad,motivo:"Creaci\xf3n de producto",usuario:"current-user",fecha:new Date,lote:c.lote,ubicacion:c.ubicacion}),(0,f.of)(c).pipe((0,I.c)(500))}updateProduct(d,c){const h=this.products.value,A=h.findIndex(T=>T.id===d);if(-1===A)return(0,e.$)(()=>new Error("Producto no encontrado"));const S=h[A],E={...S,...c,precio:Number(c.precio),cantidad:Number(c.cantidad),fechaVencimiento:c.fechaVencimiento?new Date(c.fechaVencimiento):void 0,fechaActualizacion:new Date};if(S.cantidad!==E.cantidad){const T=E.cantidad-S.cantidad;this.addInventoryMovement({productId:d,tipo:T>0?m.UB.ENTRADA:m.UB.SALIDA,cantidad:Math.abs(T),cantidadAnterior:S.cantidad,cantidadNueva:E.cantidad,motivo:"Ajuste de inventario",usuario:"current-user",fecha:new Date,lote:E.lote,ubicacion:E.ubicacion})}return h[A]=E,this.products.next([...h]),(0,f.of)(E).pipe((0,I.c)(500))}deleteProduct(d){const h=this.products.value.filter(A=>A.id!==d);return this.products.next(h),(0,f.of)(!0).pipe((0,I.c)(500))}getInventoryMovements(){return this.movements$}addInventoryMovement(d){const c={id:this.generateId(),...d};this.movements.next([c,...this.movements.value])}getStockAlerts(){return this.alerts$}markAlertAsRead(d){const c=this.alerts.value,h=c.findIndex(A=>A.id===d);return-1!==h&&(c[h].leido=!0,this.alerts.next([...c])),(0,f.of)(!0)}generateId(){return Date.now().toString()+Math.random().toString(36).substr(2,5)}searchProducts(d){return this.products$.pipe((0,v.T)(c=>c.filter(h=>h.nombre.toLowerCase().includes(d.toLowerCase())||h.codigo1.toLowerCase().includes(d.toLowerCase())||h.codigo2.toLowerCase().includes(d.toLowerCase())||h.marca.toLowerCase().includes(d.toLowerCase()))))}getProductsByCategory(d){return this.products$.pipe((0,v.T)(c=>c.filter(h=>h.categoria===d)))}getLowStockProducts(d=10){return this.products$.pipe((0,v.T)(c=>c.filter(h=>h.cantidad<=d)))}static{this.\u0275fac=function(c){return new(c||D)(C.KVO(j.Qq))}}static{this.\u0275prov=C.jDH({token:D,factory:D.\u0275fac,providedIn:"root"})}}return D})()},8384:(F,b,s)=>{s.d(b,{c:()=>r});var p=s(8359);class f extends p.yU{constructor(n,a){super()}schedule(n,a=0){return this}}const e={setInterval(o,n,...a){const{delegate:u}=e;return u?.setInterval?u.setInterval(o,n,...a):setInterval(o,n,...a)},clearInterval(o){const{delegate:n}=e;return(n?.clearInterval||clearInterval)(o)},delegate:void 0};var v=s(7908);const m={now:()=>(m.delegate||Date).now(),delegate:void 0};class C{constructor(n,a=C.now){this.schedulerActionCtor=n,this.now=a}schedule(n,a=0,u){return new this.schedulerActionCtor(this,n).schedule(u,a)}}C.now=m.now;const w=new class j extends C{constructor(n,a=C.now){super(n,a),this.actions=[],this._active=!1}flush(n){const{actions:a}=this;if(this._active)return void a.push(n);let u;this._active=!0;do{if(u=n.execute(n.state,n.delay))break}while(n=a.shift());if(this._active=!1,u){for(;n=a.shift();)n.unsubscribe();throw u}}}(class I extends f{constructor(n,a){super(n,a),this.scheduler=n,this.work=a,this.pending=!1}schedule(n,a=0){var u;if(this.closed)return this;this.state=n;const y=this.id,x=this.scheduler;return null!=y&&(this.id=this.recycleAsyncId(x,y,a)),this.pending=!0,this.delay=a,this.id=null!==(u=this.id)&&void 0!==u?u:this.requestAsyncId(x,this.id,a),this}requestAsyncId(n,a,u=0){return e.setInterval(n.flush.bind(n,this),u)}recycleAsyncId(n,a,u=0){if(null!=u&&this.delay===u&&!1===this.pending)return a;null!=a&&e.clearInterval(a)}execute(n,a){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const u=this._execute(n,a);if(u)return u;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,a){let y,u=!1;try{this.work(n)}catch(x){u=!0,y=x||new Error("Scheduled action threw falsy error")}if(u)return this.unsubscribe(),y}unsubscribe(){if(!this.closed){const{id:n,scheduler:a}=this,{actions:u}=a;this.work=this.state=this.scheduler=null,this.pending=!1,(0,v.o)(u,this),null!=n&&(this.id=this.recycleAsyncId(a,n,null)),this.delay=null,super.unsubscribe()}}}),D=w;var M=s(8793),d=s(6697),c=s(9974),h=s(4360),A=s(5343),E=s(3703),T=s(1397),R=s(8750);function k(o,n){return n?a=>(0,M.x)(n.pipe((0,d.s)(1),function S(){return(0,c.N)((o,n)=>{o.subscribe((0,h._)(n,A.l))})}()),a.pipe(k(o))):(0,T.Z)((a,u)=>(0,R.Tg)(o(a,u)).pipe((0,d.s)(1),(0,E.u)(a)))}var l=s(1985),g=s(9470);function r(o,n=w){const a=function i(o=0,n,a=D){let u=-1;return null!=n&&((0,g.m)(n)?a=n:u=n),new l.c(y=>{let x=function t(o){return o instanceof Date&&!isNaN(o)}(o)?+o-a.now():o;x<0&&(x=0);let O=0;return a.schedule(function(){y.closed||(y.next(O++),0<=u?this.schedule(void 0,u):y.complete())},x)})}(o,n);return k(()=>a)}}}]);