"use strict";(self.webpackChunkrecuento_inventory=self.webpackChunkrecuento_inventory||[]).push([[265],{5450:(w,x,a)=>{a.r(x),a.d(x,{DeliveryListComponent:()=>j});var h=a(177),E=a(8094),l=a(6354),k=a(2025),t=a(4438),b=a(9882);const f=(u,m,e)=>({"bg-yellow-100 text-yellow-800":u,"bg-green-100 text-green-800":m,"bg-purple-100 text-purple-800":e});function y(u,m){1&u&&(t.j41(0,"tr")(1,"td",34)(2,"div",35),t.qSk(),t.j41(3,"svg",36),t.nrm(4,"path",13),t.k0s(),t.joV(),t.j41(5,"p",37),t.EFF(6,"No hay entregas registradas"),t.k0s(),t.j41(7,"p",38),t.EFF(8,' Procesa tu primera entrega haciendo clic en "Nueva Entrega" '),t.k0s()()()())}function F(u,m){if(1&u){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"div",39),t.EFF(3),t.k0s(),t.j41(4,"div",40),t.EFF(5),t.k0s()(),t.j41(6,"td",41),t.EFF(7),t.nI1(8,"date"),t.k0s(),t.j41(9,"td")(10,"div",42),t.EFF(11),t.k0s()(),t.j41(12,"td")(13,"div",42),t.EFF(14),t.k0s()(),t.j41(15,"td")(16,"div",41),t.EFF(17),t.k0s(),t.j41(18,"div",43),t.EFF(19),t.k0s()(),t.j41(20,"td")(21,"span",44),t.EFF(22),t.k0s()(),t.j41(23,"td")(24,"div",45)(25,"button",46),t.bIt("click",function(){const r=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.viewDetails(r))}),t.qSk(),t.j41(26,"svg",5),t.nrm(27,"path",47)(28,"path",48),t.k0s()(),t.joV(),t.j41(29,"button",49),t.bIt("click",function(){const r=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.printDeliveryReceipt(r))}),t.qSk(),t.j41(30,"svg",5),t.nrm(31,"path",50),t.k0s()()()()()}if(2&u){const e=m.$implicit,o=t.XpG();t.R7$(3),t.SpI(" ",e.numeroSalida," "),t.R7$(2),t.SpI(" ID: ",e.solicitudPedidoId," "),t.R7$(2),t.SpI(" ",t.i5U(8,11,e.fechaEntrega,"dd/MM/yyyy HH:mm")," "),t.R7$(4),t.SpI(" ",e.funcionarioAutorizado," "),t.R7$(3),t.SpI(" ",e.funcionarioEntrega," "),t.R7$(3),t.Lme(" ",e.productos.length," producto",1!==e.productos.length?"s":""," "),t.R7$(2),t.Lme(" ",o.getTotalEntregado(e),"/",o.getTotalSolicitado(e)," unidades "),t.R7$(2),t.Y8G("ngClass",t.sMw(14,f,"PENDIENTE"===e.estado,"ENTREGADO"===e.estado,"PARCIAL"===e.estado)),t.R7$(),t.SpI(" ",e.estado," ")}}let j=(()=>{class u{constructor(e){this.deliveryService=e,this.DeliveryStatus=k.n,this.deliveries$=this.deliveryService.getDeliveries()}ngOnInit(){}getStatusCount(e){return this.deliveries$.pipe((0,l.T)(o=>o.filter(r=>r.estado===e).length))}getTotalSolicitado(e){return e.productos.reduce((o,r)=>o+r.cantidadSolicitada,0)}getTotalEntregado(e){return e.productos.reduce((o,r)=>o+r.cantidadEntregada,0)}viewDetails(e){let o="COMPROBANTE DE ENTREGA\n\n";o+=`N\xfamero de Salida: ${e.numeroSalida}\n`,o+=`Fecha de Entrega: ${e.fechaEntrega.toLocaleDateString("es-ES")} ${e.fechaEntrega.toLocaleTimeString("es-ES")}\n`,o+=`Funcionario Autorizado: ${e.funcionarioAutorizado}\n`,o+=`Funcionario que Entrega: ${e.funcionarioEntrega}\n`,o+=`Estado: ${e.estado}\n\n`,o+="PRODUCTOS ENTREGADOS:\n",e.productos.forEach((g,S)=>{o+=`\n${S+1}. ${g.descripcion}\n`,o+=`   Solicitado: ${g.cantidadSolicitada}\n`,o+=`   Entregado: ${g.cantidadEntregada}\n`,g.observaciones&&(o+=`   Observaciones: ${g.observaciones}\n`)}),e.observaciones&&(o+=`\nOBSERVACIONES GENERALES:\n${e.observaciones}`);const r=this.getTotalSolicitado(e),c=this.getTotalEntregado(e);o+="\n\nRESUMEN:\n",o+=`Total Solicitado: ${r} unidades\n`,o+=`Total Entregado: ${c} unidades\n`,o+=`Estado de Entrega: ${e.estado}`,alert(o)}printDeliveryReceipt(e){const o=this.generatePrintableReceipt(e),r=window.open("","_blank");r?(r.document.write(o),r.document.close(),r.focus(),r.print(),r.close()):alert("No se pudo abrir la ventana de impresi\xf3n")}generatePrintableReceipt(e){const o=this.getTotalSolicitado(e),r=this.getTotalEntregado(e);return`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>Comprobante de Entrega - ${e.numeroSalida}</title>\n      <style>\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }\n        .info-section { margin-bottom: 20px; }\n        .info-row { display: flex; justify-content: space-between; margin-bottom: 5px; }\n        .products-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n        .products-table th, .products-table td { border: 1px solid #000; padding: 8px; text-align: left; }\n        .products-table th { background-color: #f0f0f0; }\n        .summary { border-top: 2px solid #000; padding-top: 10px; }\n        .signatures { margin-top: 40px; display: flex; justify-content: space-between; }\n        .signature-box { text-align: center; border-top: 1px solid #000; width: 200px; padding-top: 5px; }\n      </style>\n    </head>\n    <body>\n      <div class="header">\n        <h1>COMPROBANTE DE ENTREGA</h1>\n        <h2>${e.numeroSalida}</h2>\n      </div>\n\n      <div class="info-section">\n        <div class="info-row">\n          <strong>Fecha de Entrega:</strong>\n          <span>${e.fechaEntrega.toLocaleDateString("es-ES")} ${e.fechaEntrega.toLocaleTimeString("es-ES")}</span>\n        </div>\n        <div class="info-row">\n          <strong>Funcionario Autorizado:</strong>\n          <span>${e.funcionarioAutorizado}</span>\n        </div>\n        <div class="info-row">\n          <strong>Funcionario que Entrega:</strong>\n          <span>${e.funcionarioEntrega}</span>\n        </div>\n        <div class="info-row">\n          <strong>Estado:</strong>\n          <span>${e.estado}</span>\n        </div>\n      </div>\n\n      <table class="products-table">\n        <thead>\n          <tr>\n            <th>Producto</th>\n            <th>Cantidad Solicitada</th>\n            <th>Cantidad Entregada</th>\n            <th>Observaciones</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${e.productos.map(c=>`\n            <tr>\n              <td>${c.descripcion}</td>\n              <td>${c.cantidadSolicitada}</td>\n              <td>${c.cantidadEntregada}</td>\n              <td>${c.observaciones||"-"}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n\n      <div class="summary">\n        <div class="info-row">\n          <strong>Total Solicitado:</strong>\n          <span>${o} unidades</span>\n        </div>\n        <div class="info-row">\n          <strong>Total Entregado:</strong>\n          <span>${r} unidades</span>\n        </div>\n      </div>\n\n      ${e.observaciones?`\n      <div class="info-section">\n        <strong>Observaciones:</strong>\n        <p>${e.observaciones}</p>\n      </div>\n      `:""}\n\n      <div class="signatures">\n        <div class="signature-box">\n          <div>Firma Funcionario Autorizado</div>\n          <div>${e.funcionarioAutorizado}</div>\n        </div>\n        <div class="signature-box">\n          <div>Firma Funcionario que Entrega</div>\n          <div>${e.funcionarioEntrega}</div>\n        </div>\n      </div>\n\n      <div style="margin-top: 40px; text-align: center; font-size: 12px; color: #666;">\n        Documento generado el ${(new Date).toLocaleDateString("es-ES")} a las ${(new Date).toLocaleTimeString("es-ES")}\n      </div>\n    </body>\n    </html>\n    `}static{this.\u0275fac=function(o){return new(o||u)(t.rXU(b.K))}}static{this.\u0275cmp=t.VBU({type:u,selectors:[["app-delivery-list"]],standalone:!0,features:[t.aNF],decls:84,vars:18,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["routerLink","/salida-pedido",1,"btn","btn-primary","flex","items-center","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"card","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-600"],[1,"w-12","h-12","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"w-12","h-12","bg-yellow-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-2xl","font-bold","text-green-600"],[1,"w-12","h-12","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-2xl","font-bold","text-purple-600"],[1,"w-12","h-12","bg-purple-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"card","overflow-hidden"],[1,"p-4","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"table"],[1,"bg-gray-50"],[4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","7",1,"text-center","py-8","text-gray-500"],[1,"flex","flex-col","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mb-3","text-gray-300"],[1,"font-medium"],[1,"text-sm"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-900"],[1,"text-xs","text-gray-400"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"flex","items-center","space-x-2"],["title","Ver detalles",1,"text-primary-600","hover:text-primary-900","text-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Imprimir comprobante",1,"text-green-600","hover:text-green-900","text-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"]],template:function(o,r){if(1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),t.EFF(4,"Registro de Entregas"),t.k0s(),t.j41(5,"p",3),t.EFF(6,"Gesti\xf3n de entregas y salidas de pedidos"),t.k0s()(),t.j41(7,"a",4),t.qSk(),t.j41(8,"svg",5),t.nrm(9,"path",6),t.k0s(),t.joV(),t.j41(10,"span"),t.EFF(11,"Nueva Entrega"),t.k0s()()(),t.j41(12,"div",7)(13,"div",8)(14,"div",9)(15,"div")(16,"p",10),t.EFF(17,"Total Entregas"),t.k0s(),t.j41(18,"p",2),t.EFF(19),t.nI1(20,"async"),t.k0s()(),t.j41(21,"div",11),t.qSk(),t.j41(22,"svg",12),t.nrm(23,"path",13),t.k0s()()()(),t.joV(),t.j41(24,"div",8)(25,"div",9)(26,"div")(27,"p",10),t.EFF(28,"Pendientes"),t.k0s(),t.j41(29,"p",14),t.EFF(30),t.nI1(31,"async"),t.k0s()(),t.j41(32,"div",15),t.qSk(),t.j41(33,"svg",16),t.nrm(34,"path",17),t.k0s()()()(),t.joV(),t.j41(35,"div",8)(36,"div",9)(37,"div")(38,"p",10),t.EFF(39,"Entregadas"),t.k0s(),t.j41(40,"p",18),t.EFF(41),t.nI1(42,"async"),t.k0s()(),t.j41(43,"div",19),t.qSk(),t.j41(44,"svg",20),t.nrm(45,"path",21),t.k0s()()()(),t.joV(),t.j41(46,"div",8)(47,"div",9)(48,"div")(49,"p",10),t.EFF(50,"Parciales"),t.k0s(),t.j41(51,"p",22),t.EFF(52),t.nI1(53,"async"),t.k0s()(),t.j41(54,"div",23),t.qSk(),t.j41(55,"svg",24),t.nrm(56,"path",25),t.k0s()()()()(),t.joV(),t.j41(57,"div",26)(58,"div",27)(59,"h3",28),t.EFF(60,"Entregas Recientes"),t.k0s()(),t.j41(61,"div",29)(62,"table",30)(63,"thead",31)(64,"tr")(65,"th"),t.EFF(66,"N\xfamero de Salida"),t.k0s(),t.j41(67,"th"),t.EFF(68,"Fecha Entrega"),t.k0s(),t.j41(69,"th"),t.EFF(70,"Funcionario Autorizado"),t.k0s(),t.j41(71,"th"),t.EFF(72,"Funcionario Entrega"),t.k0s(),t.j41(73,"th"),t.EFF(74,"Productos"),t.k0s(),t.j41(75,"th"),t.EFF(76,"Estado"),t.k0s(),t.j41(77,"th"),t.EFF(78,"Acciones"),t.k0s()()(),t.j41(79,"tbody"),t.DNE(80,y,9,0,"tr",32),t.nI1(81,"async"),t.DNE(82,F,32,18,"tr",33),t.nI1(83,"async"),t.k0s()()()()()),2&o){let c,g;t.R7$(19),t.SpI(" ",(null==(c=t.bMT(20,6,r.deliveries$))?null:c.length)||0," "),t.R7$(11),t.SpI(" ",t.bMT(31,8,r.getStatusCount(r.DeliveryStatus.PENDIENTE))," "),t.R7$(11),t.SpI(" ",t.bMT(42,10,r.getStatusCount(r.DeliveryStatus.ENTREGADO))," "),t.R7$(11),t.SpI(" ",t.bMT(53,12,r.getStatusCount(r.DeliveryStatus.PARCIAL))," "),t.R7$(28),t.Y8G("ngIf",0===(null==(g=t.bMT(81,14,r.deliveries$))?null:g.length)),t.R7$(2),t.Y8G("ngForOf",t.bMT(83,16,r.deliveries$))}},dependencies:[h.MD,h.YU,h.Sq,h.bT,h.Jj,h.vh,E.iI,E.Wk],encapsulation:2})}}return u})()},2025:(w,x,a)=>{a.d(x,{S:()=>h,n:()=>E});var h=function(l){return l.PENDIENTE="PENDIENTE",l.PROCESADA="PROCESADA",l.RECHAZADA="RECHAZADA",l}(h||{}),E=function(l){return l.PENDIENTE="PENDIENTE",l.ENTREGADO="ENTREGADO",l.PARCIAL="PARCIAL",l}(E||{})},8384:(w,x,a)=>{a.d(x,{c:()=>C});var h=a(8359);class E extends h.yU{constructor(n,i){super()}schedule(n,i=0){return this}}const l={setInterval(d,n,...i){const{delegate:s}=l;return s?.setInterval?s.setInterval(d,n,...i):setInterval(d,n,...i)},clearInterval(d){const{delegate:n}=l;return(n?.clearInterval||clearInterval)(d)},delegate:void 0};var k=a(7908);const b={now:()=>(b.delegate||Date).now(),delegate:void 0};class f{constructor(n,i=f.now){this.schedulerActionCtor=n,this.now=i}schedule(n,i=0,s){return new this.schedulerActionCtor(this,n).schedule(s,i)}}f.now=b.now;const F=new class y extends f{constructor(n,i=f.now){super(n,i),this.actions=[],this._active=!1}flush(n){const{actions:i}=this;if(this._active)return void i.push(n);let s;this._active=!0;do{if(s=n.execute(n.state,n.delay))break}while(n=i.shift());if(this._active=!1,s){for(;n=i.shift();)n.unsubscribe();throw s}}}(class t extends E{constructor(n,i){super(n,i),this.scheduler=n,this.work=i,this.pending=!1}schedule(n,i=0){var s;if(this.closed)return this;this.state=n;const p=this.id,v=this.scheduler;return null!=p&&(this.id=this.recycleAsyncId(v,p,i)),this.pending=!0,this.delay=i,this.id=null!==(s=this.id)&&void 0!==s?s:this.requestAsyncId(v,this.id,i),this}requestAsyncId(n,i,s=0){return l.setInterval(n.flush.bind(n,this),s)}recycleAsyncId(n,i,s=0){if(null!=s&&this.delay===s&&!1===this.pending)return i;null!=i&&l.clearInterval(i)}execute(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(n,i);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,i){let p,s=!1;try{this.work(n)}catch(v){s=!0,p=v||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),p}unsubscribe(){if(!this.closed){const{id:n,scheduler:i}=this,{actions:s}=i;this.work=this.state=this.scheduler=null,this.pending=!1,(0,k.o)(s,this),null!=n&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,super.unsubscribe()}}}),j=F;var u=a(8793),m=a(6697),e=a(9974),o=a(4360),r=a(5343),g=a(3703),S=a(1397),$=a(8750);function A(d,n){return n?i=>(0,u.x)(n.pipe((0,m.s)(1),function c(){return(0,e.N)((d,n)=>{d.subscribe((0,o._)(n,r.l))})}()),i.pipe(A(d))):(0,S.Z)((i,s)=>(0,$.Tg)(d(i,s)).pipe((0,m.s)(1),(0,g.u)(i)))}var D=a(1985),I=a(9470);function C(d,n=F){const i=function R(d=0,n,i=j){let s=-1;return null!=n&&((0,I.m)(n)?i=n:s=n),new D.c(p=>{let v=function T(d){return d instanceof Date&&!isNaN(d)}(d)?+d-i.now():d;v<0&&(v=0);let N=0;return i.schedule(function(){p.closed||(p.next(N++),0<=s?this.schedule(void 0,s):p.complete())},v)})}(d,n);return A(()=>i)}}}]);