"use strict";(self.webpackChunkrecuento_inventory=self.webpackChunkrecuento_inventory||[]).push([[292],{2292:(j,c,s)=>{s.r(c),s.d(c,{InvoiceListComponent:()=>x});var a=s(177),d=s(8094),u=s(6354),v=s(2025),t=s(4438),m=s(5633);const g=(r,l,e)=>({"bg-yellow-100 text-yellow-800":r,"bg-green-100 text-green-800":l,"bg-red-100 text-red-800":e});function _(r,l){1&r&&(t.j41(0,"tr")(1,"td",35)(2,"div",36),t.qSk(),t.j41(3,"svg",37),t.nrm(4,"path",13),t.k0s(),t.joV(),t.j41(5,"p",38),t.EFF(6,"No hay facturas registradas"),t.k0s(),t.j41(7,"p",39),t.EFF(8,' Registra tu primera factura haciendo clic en "Registrar Factura" '),t.k0s()()()())}function k(r,l){if(1&r){const e=t.RV6();t.j41(0,"div",59)(1,"div",60)(2,"button",61),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2).$implicit,i=t.XpG();return t.Njj(i.updateStatus(o.id,i.InvoiceStatus.PROCESADA))}),t.EFF(3," Marcar como Procesada "),t.k0s(),t.j41(4,"button",61),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2).$implicit,i=t.XpG();return t.Njj(i.updateStatus(o.id,i.InvoiceStatus.RECHAZADA))}),t.EFF(5," Rechazar "),t.k0s()()()}}function h(r,l){if(1&r){const e=t.RV6();t.j41(0,"div",55)(1,"button",56),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,i=t.XpG();return t.Njj(i.toggleStatusMenu(o.id))}),t.qSk(),t.j41(2,"svg",5),t.nrm(3,"path",57),t.k0s()(),t.DNE(4,k,6,0,"div",58),t.k0s()}if(2&r){const e=t.XpG().$implicit,n=t.XpG();t.R7$(4),t.Y8G("ngIf",n.openStatusMenu===e.id)}}function F(r,l){if(1&r){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"div",40),t.EFF(3),t.k0s(),t.j41(4,"div",41),t.EFF(5),t.k0s()(),t.j41(6,"td",42),t.EFF(7),t.nI1(8,"date"),t.k0s(),t.j41(9,"td")(10,"div",43),t.EFF(11),t.k0s()(),t.j41(12,"td")(13,"div",42),t.EFF(14),t.k0s(),t.j41(15,"div",44),t.EFF(16),t.k0s()(),t.j41(17,"td")(18,"div",45),t.EFF(19),t.nI1(20,"number"),t.k0s()(),t.j41(21,"td")(22,"span",46),t.EFF(23),t.k0s()(),t.j41(24,"td")(25,"div",47),t.qSk(),t.j41(26,"svg",48),t.nrm(27,"path",49),t.k0s(),t.joV(),t.j41(28,"span",42),t.EFF(29),t.k0s()()(),t.j41(30,"td")(31,"div",50)(32,"button",51),t.bIt("click",function(){const o=t.eBV(e).$implicit,i=t.XpG();return t.Njj(i.viewDetails(o))}),t.qSk(),t.j41(33,"svg",5),t.nrm(34,"path",52)(35,"path",53),t.k0s()(),t.DNE(36,h,5,1,"div",54),t.k0s()()()}if(2&r){const e=l.$implicit,n=t.XpG();t.R7$(3),t.SpI(" ",e.numeroFactura," "),t.R7$(2),t.SpI("ID: ",e.id,""),t.R7$(2),t.SpI(" ",t.i5U(8,12,e.fecha,"dd/MM/yyyy")," "),t.R7$(4),t.SpI(" ",e.proveedor," "),t.R7$(3),t.Lme(" ",e.productos.length," producto",1!==e.productos.length?"s":""," "),t.R7$(2),t.SpI(" ",n.getTotalProductQuantity(e)," unidades "),t.R7$(3),t.SpI(" $",t.i5U(20,15,e.montoTotal,"1.2-2")," "),t.R7$(3),t.Y8G("ngClass",t.sMw(18,g,"PENDIENTE"===e.estado,"PROCESADA"===e.estado,"RECHAZADA"===e.estado)),t.R7$(),t.SpI(" ",e.estado," "),t.R7$(6),t.SpI(" ",e.documentos.length," "),t.R7$(7),t.Y8G("ngIf","PENDIENTE"===e.estado)}}let x=(()=>{class r{constructor(e){this.invoiceService=e,this.openStatusMenu=null,this.InvoiceStatus=v.S,this.invoices$=this.invoiceService.getInvoices()}ngOnInit(){}getStatusCount(e){return this.invoices$.pipe((0,u.T)(n=>n.filter(o=>o.estado===e).length))}getTotalAmount(){return this.invoices$.pipe((0,u.T)(e=>e.reduce((n,o)=>n+o.montoTotal,0)))}getTotalProductQuantity(e){return e.productos.reduce((n,o)=>n+o.cantidad,0)}viewDetails(e){let n="FACTURA REGISTRADA\n\n";n+=`N\xfamero: ${e.numeroFactura}\n`,n+=`Fecha: ${e.fecha.toLocaleDateString("es-ES")}\n`,n+=`Proveedor: ${e.proveedor}\n`,n+=`Estado: ${e.estado}\n`,n+=`Monto Total: $${e.montoTotal.toFixed(2)}\n\n`,n+="PRODUCTOS:\n",e.productos.forEach((o,i)=>{n+=`\n${i+1}. ${o.descripcion}\n`,n+=`   Cantidad: ${o.cantidad}\n`,n+=`   Precio Unitario: $${o.precioUnitario.toFixed(2)}\n`,n+=`   Subtotal: $${o.subtotal.toFixed(2)}\n`}),e.notas&&(n+=`\nNOTAS:\n${e.notas}`),e.documentos.length>0&&(n+=`\nDOCUMENTOS: ${e.documentos.length} archivo(s)`),alert(n)}toggleStatusMenu(e){this.openStatusMenu=this.openStatusMenu===e?null:e}updateStatus(e,n){this.invoiceService.updateInvoiceStatus(e,n).subscribe({next:()=>{console.log(`Invoice status updated to ${n}`),this.openStatusMenu=null},error:o=>{console.error("Error updating status:",o),alert("Error al actualizar el estado")}})}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(m.p))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-invoice-list"]],standalone:!0,features:[t.aNF],decls:88,vars:21,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["routerLink","/registro-factura",1,"btn","btn-primary","flex","items-center","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"card","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-600"],[1,"w-12","h-12","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"w-12","h-12","bg-yellow-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-2xl","font-bold","text-green-600"],[1,"w-12","h-12","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-2xl","font-bold","text-purple-600"],[1,"w-12","h-12","bg-purple-100","rounded-lg","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-purple-600"],["d","M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z","clip-rule","evenodd"],[1,"card","overflow-hidden"],[1,"p-4","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],[1,"overflow-x-auto"],[1,"table"],[1,"bg-gray-50"],[4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","8",1,"text-center","py-8","text-gray-500"],[1,"flex","flex-col","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mb-3","text-gray-300"],[1,"font-medium"],[1,"text-sm"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-900"],[1,"text-xs","text-gray-400"],[1,"text-sm","font-medium","text-gray-900"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"flex","items-center","space-x-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"],[1,"flex","items-center","space-x-2"],["title","Ver detalles",1,"text-primary-600","hover:text-primary-900","text-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","relative",4,"ngIf"],[1,"relative"],["title","Cambiar estado",1,"text-gray-600","hover:text-gray-900","text-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"],["class","absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",4,"ngIf"],[1,"absolute","right-0","mt-2","w-48","bg-white","rounded-md","shadow-lg","z-10","border","border-gray-200"],[1,"py-1"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100",3,"click"]],template:function(n,o){if(1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),t.EFF(4,"Registro de Facturas"),t.k0s(),t.j41(5,"p",3),t.EFF(6,"Gesti\xf3n de facturas registradas"),t.k0s()(),t.j41(7,"a",4),t.qSk(),t.j41(8,"svg",5),t.nrm(9,"path",6),t.k0s(),t.joV(),t.j41(10,"span"),t.EFF(11,"Registrar Factura"),t.k0s()()(),t.j41(12,"div",7)(13,"div",8)(14,"div",9)(15,"div")(16,"p",10),t.EFF(17,"Total Facturas"),t.k0s(),t.j41(18,"p",2),t.EFF(19),t.nI1(20,"async"),t.k0s()(),t.j41(21,"div",11),t.qSk(),t.j41(22,"svg",12),t.nrm(23,"path",13),t.k0s()()()(),t.joV(),t.j41(24,"div",8)(25,"div",9)(26,"div")(27,"p",10),t.EFF(28,"Pendientes"),t.k0s(),t.j41(29,"p",14),t.EFF(30),t.nI1(31,"async"),t.k0s()(),t.j41(32,"div",15),t.qSk(),t.j41(33,"svg",16),t.nrm(34,"path",17),t.k0s()()()(),t.joV(),t.j41(35,"div",8)(36,"div",9)(37,"div")(38,"p",10),t.EFF(39,"Procesadas"),t.k0s(),t.j41(40,"p",18),t.EFF(41),t.nI1(42,"async"),t.k0s()(),t.j41(43,"div",19),t.qSk(),t.j41(44,"svg",20),t.nrm(45,"path",21),t.k0s()()()(),t.joV(),t.j41(46,"div",8)(47,"div",9)(48,"div")(49,"p",10),t.EFF(50,"Monto Total"),t.k0s(),t.j41(51,"p",22),t.EFF(52),t.nI1(53,"async"),t.nI1(54,"number"),t.k0s()(),t.j41(55,"div",23),t.qSk(),t.j41(56,"svg",24),t.nrm(57,"path",25)(58,"path",26),t.k0s()()()()(),t.joV(),t.j41(59,"div",27)(60,"div",28)(61,"h3",29),t.EFF(62,"Facturas Recientes"),t.k0s()(),t.j41(63,"div",30)(64,"table",31)(65,"thead",32)(66,"tr")(67,"th"),t.EFF(68,"N\xfamero de Factura"),t.k0s(),t.j41(69,"th"),t.EFF(70,"Fecha"),t.k0s(),t.j41(71,"th"),t.EFF(72,"Proveedor"),t.k0s(),t.j41(73,"th"),t.EFF(74,"Productos"),t.k0s(),t.j41(75,"th"),t.EFF(76,"Monto Total"),t.k0s(),t.j41(77,"th"),t.EFF(78,"Estado"),t.k0s(),t.j41(79,"th"),t.EFF(80,"Documentos"),t.k0s(),t.j41(81,"th"),t.EFF(82,"Acciones"),t.k0s()()(),t.j41(83,"tbody"),t.DNE(84,_,9,0,"tr",33),t.nI1(85,"async"),t.DNE(86,F,37,22,"tr",34),t.nI1(87,"async"),t.k0s()()()()()),2&n){let i,p;t.R7$(19),t.SpI(" ",(null==(i=t.bMT(20,6,o.invoices$))?null:i.length)||0," "),t.R7$(11),t.SpI(" ",t.bMT(31,8,o.getStatusCount(o.InvoiceStatus.PENDIENTE))," "),t.R7$(11),t.SpI(" ",t.bMT(42,10,o.getStatusCount(o.InvoiceStatus.PROCESADA))," "),t.R7$(11),t.SpI(" $",t.i5U(54,14,t.bMT(53,12,o.getTotalAmount()),"1.2-2")," "),t.R7$(32),t.Y8G("ngIf",0===(null==(p=t.bMT(85,17,o.invoices$))?null:p.length)),t.R7$(2),t.Y8G("ngForOf",t.bMT(87,19,o.invoices$))}},dependencies:[a.MD,a.YU,a.Sq,a.bT,a.Jj,a.QX,a.vh,d.iI,d.Wk],encapsulation:2})}}return r})()}}]);